<div class="content-area">
  <div class="content-inner">
    <!--页面标题-->
    <div class="nav-title">
      <a><h4>投票信息</h4></a>
      <div class="b-head-right">
        <div class="content-box" tabindex="0" onclick="history.go(-1);">
          <i class="icon-reload"></i> 返回
        </div>
      </div>
    </div>
    <!--信息内容-->
    <div class="warp">
      <div class="warp-right">
        <div  class="form-group">
          <label  class="control-label"><span>标题</span>
            <textarea class="form-control" id="title" rows="2"
                      name="summary" placeholder=""
                      [(ngModel)]="copyVote.title"
                      (blur)="verifyEmpty(copyVote.title,'title')">
              </textarea>
          </label>
          <div class="error"></div>
        </div>
        <div  class="form-group">
          <label  class="control-label"><span>简介</span>
            <textarea class="form-control" id="content" rows="8"
                      name="content" placeholder=""
                      [(ngModel)]="copyVote.content"
                      (blur)="verifyEmpty(copyVote.content,'content')">
              </textarea>
          </label>
          <div class="error"></div>
        </div>
        <div  class="form-group">
          <label  class="control-label"><span>截至日期</span>
            <input class="form-control" id="eTime" name="eTime" placeholder="" type="date"
                   style="width: 200px"
                   [(ngModel)]="copyVote.eTime"
                   (blur)="verifyEmpty(copyVote.eTime,'eTime')">
          </label>
          <div class="error"></div>
        </div>
        <div  class="form-group">
          <label  class="control-label" (click)="openChooseWin()">
            <span>开放范围</span>
            <textarea class="form-control" rows="4" style="line-height: 20px"
                      id="deptName" name="deptName" readonly
                      [(ngModel)]="copyVote.targetName"
                      (blur)="verifyEmpty(copyVote.targetName,'deptName')"
            >
            </textarea>
          </label>
          <div class="error"></div>
        </div>
        <div class="modal-more" id="deptSltWin" style="display: none">
          <h5>杭州移动各部门</h5>
          <h5>已选：&nbsp;&nbsp;<span>{{copyVote.targetName}}</span></h5>
          <div class="choose-group">
            <label class="cb-blue">
              <input type="checkbox" name="userDept" [(ngModel)]="isMyDept" [value]="user.deptId"
                     (change)="setMyDept(user.deptId)">
              <span>本部门</span>
            </label>
          </div>
          <div class="choose-group">
            <label class="cb-blue">
              <input type="checkbox" name="all" id="all" [(ngModel)]="isAllDept" (change)="chooseAll()">
              <span>全公司</span>
            </label>
          </div>
          <div class="choose-list">
            <div class="choose-group" *ngFor="let dept of deptList;let i=index">
              <label class="cb-blue">
                <input type="checkbox" [name]="dept.DEPT_ID" [(ngModel)]="dept.choose"
                       [value]="dept.DEPT_ID"
                       (change)="chooseDept()">
                <span>{{dept.DEPT_NAME}}</span>
              </label>
            </div>
          </div>
          <div  class="modal-more-footer">
            <button  class="btn btn-info" type="submit"
                     onclick="$('#deptSltWin').fadeOut()">确定</button>
          </div>
        </div>
        <div  class="form-group">
          <label  class="control-label"><span>投票方式</span>
            <label for="single">
              <input id="single" name="type" type="radio" value="single"
                     [(ngModel)]="copyVote.type" (change)="clearResult()">
              单选
            </label>
            <label for="double">
              <input id="double" name="type" type="radio" value="double"
                     [(ngModel)]="copyVote.type" (change)="clearResult()">
              多选
            </label>
          </label>
          <div class="error"></div>
        </div>
        <div  class="form-group" [@diamond]="copyVote.type ==='double'?'lower':'upper'">
          <label  class="control-label"><span>投票配置</span>
            <label for="number">
              <input id="number" name="resultType" type="radio" value="number"
                     [(ngModel)]="copyVote.resultType" (change)="clearResult()">
              指定个数
              <span [@diamond]="copyVote.resultType === 'number'?'show':'none'">&nbsp;&nbsp;
                <input type="number" class="form-control" style="width: 80px"
                       name="maxResult" [(ngModel)]="copyVote.maxResult"
                      (blur)="verifyNumberRange(copyVote.maxResult,'number',2)">项
              </span>
            </label>
            <div class="error"></div>
          </label>
          <div>
            <label  class="control-label"><span></span>
              <label for="range">
                <input id="range" name="resultType" type="radio" value="range"
                       [(ngModel)]="copyVote.resultType" (change)="clearResult()">
                指定范围
                <span [@diamond]="copyVote.resultType === 'range'?'show':'none'">&nbsp;&nbsp;最多选
                  <input type="number" class="form-control" style="width: 80px" name="maxResult"
                         [(ngModel)]="copyVote.maxResult"
                         (blur)="verifyNumberRange(copyVote.maxResult,'range',copyVote.minResult+1)">项
                &nbsp;&nbsp;最少选
                  <input type="number" class="form-control" style="width: 80px" name="minResult"
                         [(ngModel)]="copyVote.minResult"
                         (blur)="verifyNumberRange(copyVote.minResult,'range',1,copyVote.maxResult-1)">项
                </span>
              </label>
              <div class="error"></div>
            </label>
          </div>
        </div>
        <div  class="form-group">
          <div  class="control-label"><span>选项</span>
            <ul class="control-list">
              <li *ngFor="let option of copyVote.options;let i = index" [@diamond]="option?'active':''">
                <h5>选项（{{i+1}}）<span *ngIf="i!=0" (click)="delOption(i)">删除</span></h5>
                <div class="warp-left">
                  <div  class="dropify-wrapper bpt">
                    <div  class="dropify-message">
                      <img [src]="option.imgContent | imgsafeurl" *ngIf="option.imgContent">
                    </div>
                    <p>上传图片</p>
                    <input  class="dropify" type="file" name="imgPath"
                            (change)="prese_upload($event.target.files,i)">
                  </div>
                </div>
                <div class="warp-left" style="padding-left: 20px">
                  <div  class="form-group">
                    <label  class="control-label">
                      <span>选项名称</span>
                      <input class="form-control" type="text" style="width: 260px"
                                [(ngModel)]="option.title">
                    </label>
                    <div class="error"></div>
                  </div>
                  <div  class="form-group">
                    <label  class="control-label">
                      <span>选项内容</span>
                      <textarea class="form-control" rows="3" style="line-height: 24px;width: 560px"
                                [(ngModel)]="option.content">
                      </textarea>
                    </label>
                    <div class="error"></div>
                  </div>
                </div>
              </li>
              <li class="box-add">
                <a (click)="addNewOption()"><i class="icon-plus"></i>&nbsp;添加选项</a>
              </li>
            </ul>
          </div>
          <div class="error"></div>
        </div>
      </div>
      <div style="clear: both;"></div>
      <div class="foot-submit">
        <a class="btn btn-info" (click)="submit()">提交</a>
      </div>
    </div>
  </div>
</div>
